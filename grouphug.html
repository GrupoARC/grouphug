<head>
  <title>grouphug</title>
</head>

<template name="main">
  {{> navbar}}
  {{> yield}}
  <hr />
</template>

<template name="navbar">
  <p>
  <a href="{{pathFor route="root"}}">GroupHug</a> -
  <a href="{{pathFor route="roomList"}}">Room List</a> -
  {{> loginButtons}}
  </p>
</template>

<template name="root">
  <h1>Welcome to GroupHug</h1>
</template>

<template name="register">
  <h2>Register</h2>
  <form class="register">
    <p>Email: <input type="email" name="email"></p>
    <p>Password: <input type="password" name="password"></p>
    <p><input type="submit" value="Register"></p>
  </form> 
</template>

<template name="login">
  <h2>Login</h2>
  <form class="login">
      <p>Email: <input type="email" name="email" required></p>
      <p>Password: <input type="password" name="password" required></p>
      <p><input type="submit" value="Login"></p>
  </form>
</template>

<template name="roomList">
  <h2>Rooms:</h2>
  <ul>
    {{#each rooms}}
      <li><a href="/room/{{name}}">{{name}}</a></li>
    {{/each}}
  </ul>
</template>

<template name="actions">
  <p>
  <a href="{{pathFor route="room" roomName=this.name}}">View</a> -
  <a href="{{pathFor route="room" roomName=this.name}}?view=editor">Edit</a> -
  <a href="{{pathFor route="room" roomName=this.name}}?view=history">History</a>
  </p>
</template>

<template name="showRoom">
  {{> actions}}
  <h2>{{name}}</h2>
  {{text}}
  {{> chat}}
</template>

<template name="roomEditor">
  {{#if currentUser}}     
  {{> actions}}
  <h2>Edit {{name}}:</h2>
    <form>
      <textarea name="roomText" rows="25" cols="80">{{text}}</textarea>
    </form>
    <button class="saveRoom">Save</button>
  {{else}}
    You must be logged in to edit a page.
  {{/if}}
</template>

<template name="roomHistory">
  {{> actions}}
  <h2>History of {{name}}:</h2>
  <ul>
    {{#each versions}}
      <li>{{created}} by {{author.username}}</li>
    {{/each}}
  </ul>
</template>

<template name="chat">
    <div>
    {{#if currentUser}}
    {{> chatInput}}
    {{/if}}
    {{> chatMessages}}
    </div>
</template>

<template name="chatInput">
    <input type="text" id="msg" placeholder="Your message goes here..." style="width: 50%; margin-bottom: 0px">
    <input type="button" value="Send message" class="btn btn-primary sendMsg">
</template>

<template name="chatMessages">
    <h4>Room: {{name}}</h4>
    <div id="messages" style="background-color: #ffffff; border: 1px solid darkgray; max-height: 200px; overflow: auto">
        {{#each messages}}
            {{> chatMessage}}
        {{/each}}
    </div>
</template>

<template name="chatMessage">
    <p><strong>{{user}}</strong> <span style="font-size: 0.7em; color: darkgray">({{timestamp}})</span>: <i>{{msg}}</i></p>
</template>


